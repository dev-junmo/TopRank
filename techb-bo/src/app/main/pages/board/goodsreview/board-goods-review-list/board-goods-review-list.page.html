<!-- header-->
<bo-page-header [imgUrl]="'assets/img/03-5-board-2.svg'" [title]="'상품후기 관리'">

    <!-- 게시글등록 버튼-->
    <!-- <bo-page-button-config id = "id-board-content-list-btn-create"
        [title]="'게시글등록'"
        [styleType] = "'round-m-darkgrey'"
        (click) = "createItem($event)">
    </bo-page-button-config> -->
    <!-- 사용자화면 버튼-->
    <bo-page-button-config id = "id-board-content-list-btn-userview"
        [title] = "'사용자화면'"
        [styleType] = "'square-m-white-btn'"
        (click) = "onClickClientView()">
    </bo-page-button-config>
</bo-page-header>
<div class="list-section">

    <!-- query form -->
    <board-goods-review-query-form [setQuery]="query"(query)="reloadWithQuery($event)"></board-goods-review-query-form>

    <bo-page-padding></bo-page-padding>

    <div class="list-wrap-se">
        <!-- list -->
        <div style="margin: auto; max-width: 100%; margin-bottom: 50px;">
            <data-table #bsDatatable
                headerTitle="datatable"
                [header]="true"
                [items]="items"
                [itemCount]="itemCount"
                [indexColumn]="true"
                [selectColumn]="!appConfig.isProvider"
                (reload)="reloadItems($event)"
                [sortBy] = "'seq'"
                [sortAsc] = "false">

                <!-- <bs-header-button-config id = "id-board-list-selected-btn"
                    [title] = "'선택삭제'"
                    [styleType] = "'square-s-greyborder-btn'"
                    (click) = "deleteSelectedItem($event , 'seq')"
                    *ngIf="!appConfig.isProvider">
                </bs-header-button-config> -->

                <bs-header-button-config id = "id-board-list-selected-btn"
                    [title] = "'선택미노출'"
                    [styleType] = "'square-s-greyborder-btn'"
                    (click) = "onClickSelectChangeHiddenStatus($event)"
                    *ngIf="!appConfig.isProvider">
                </bs-header-button-config>

                <data-table-column
                    *ngIf="!appConfig.isProvider"
                    [property]="'best'"
                    [header]="'베스트'"
                    [sortable]="true"
                    [width]="66">
                    <ng-template #dataTableHeader let-item="item">
                            베스트
                    </ng-template>
                    <ng-template #dataTableCell let-item="item">
                        <span *ngIf="item.best == 'none'" (click)="onClickBestItem(item.seq , 'checked' , item)"><img src="/assets/img/btn_star-01.png" /></span>
                        <span *ngIf="item.best == 'checked'" (click)="onClickBestItem(item.seq, 'none',  item)"><img src="/assets/img/btn_star-02.png" /></span>
                    </ng-template>
                </data-table-column>
                <!-- <data-table-column
                    [property]="'seq'"
                    [header]="'번호'"
                    [sortable]="true"
                    [width]="80">
                </data-table-column> -->

                <data-table-column
                [property]="'category'"
                [header]="'분류'"
                [align]="'center'"
                [sortable]="true"
                [width]="100">
                <ng-template #dataTableCell let-item="item">
                    <!-- <div class="table-con-overflow" style="width:100px;max-height: 35px" [innerHTML]="item?.category"></div> -->
                    <div *ngIf="item.category =='포토후기'" class="blue">{{item.category}}</div>
                    <div *ngIf="item.category =='일반후기'">{{item.category}}</div>
                </ng-template>
                </data-table-column>

                <data-table-column
                    [property]="'goods_image'"
                    [header]="'이미지'"
                    [width]="80">
                    <!-- <ng-template #dataTableCell let-item="item" >
                        <img (click)="updateItem(item.goods_seq)" [src] = "item.goods_image"  style="width: 44px; height: 44px;">
                    </ng-template> -->
                    <ng-template #dataTableCell let-item="item" >
                        <a target="_blank" href="{{clientURL+'/goods/view/'+item.goods_seq}}">
                            <img  [src] = "item.goods_image"  style="width: 44px; height: 44px;">
                        </a>
                    </ng-template>
                </data-table-column>

                <data-table-column
                    [property]="'goods_name'"
                    [header]="'상품명'"
                    [sortable]="true"
                    [align]="'left'"
                    [clickable]="true">
                    <ng-template #dataTableCell let-item="item" >
                        <div (click)="onClickViewItem(item , template)">
                            <span><strong>{{item?.goods?.goods_name}}</strong></span><br>
                            <span>{{item?.contents | stringLimit:50}}</span>
                        </div>
                    </ng-template>
                </data-table-column>

                <data-table-column
                    property="name"
                    header="작성자"
                    [width]="100">
                </data-table-column>

                <data-table-column
                    [property]="'regist_date'"
                    [header]="'등록일'"
                    [width]="100"
                    [sortable]="true">
                    <ng-template #dataTableCell let-item="item" >
                        <span>{{item.regist_date | date: 'yyyy-MM-dd'}}</span>
                    </ng-template>
                </data-table-column>

                <data-table-column
                    [property]="'score'"
                    [header]="'평점'"
                    [width]="120"
                    [sortable]="true">
                    <ng-template #dataTableCell let-item="item" >
                        <bs-rating #small [values]="item?.score" [max]="max" [isReadonly]="isReadonly" [style]="'star2'"></bs-rating>
                    </ng-template>
                </data-table-column>

                <data-table-column
                    [property]="'hit'"
                    [header]="'조회수'"
                    [width]="70"
                    [sortable]="true">
                </data-table-column>

                <data-table-column
                    [header]="'화면보기'"
                    [width]="120">
                    <ng-template #dataTableHeader let-item="item">
                        화면보기
                    </ng-template>
                    <ng-template #dataTableCell let-item="item">
                        <a target="_blank" href="{{apiURL + '/admin/gateway/entrance?returnUrl=' + clientURL+'/goods/view/'+item.goods_seq+'?nocache=1'}}">
                            <bo-page-button [type]="'s-lightnavy'" [title]="'사용자화면'"></bo-page-button>
                        </a>
                    </ng-template>
                </data-table-column>
                <data-table-column
                    [property]="'hidden'"
                    [header]="'노출'"
                    [width]="80"
                    *ngIf="!appConfig.isProvider">
                    <ng-template #dataTableCell let-item="item">
                            <ui-switch (change)="onClickChangeHiddenStatus($event, item)" [checked]="item.hidden == 0" size="small" color="#e7e7e7" switchColor="rgb(234,0,61)" switchOffColor="rgb(150,150,150)" defaultBgColor="#dadada" defaultBoColor="#dadada"></ui-switch>
                    </ng-template>
                </data-table-column>

                <data-table-column
                    [property]="'re_contents'"
                    [header]="'답변상태'"
                    [sortable]="true"
                    [width]="120">
                    <ng-template #dataTableCell let-item="item">
                        <div *ngIf="item.re_contents">답변</div>
                        <div *ngIf="!item.re_contents" class="red">미답변</div>
                    </ng-template>
                </data-table-column>

                <data-table-column
                    header="manage"
                    [width]="350"
                    *ngIf="!appConfig.isProvider">
                    <ng-template #dataTableHeader let-item="item">
                        관리
                    </ng-template>
                    <ng-template #dataTableCell let-item="item">
                        <bo-button-collection *ngIf="item.best == 'none'" class="margin-class" [title]="'베스트후기로 등록'" 
                            [id]="'edit'"  (click)="onClickBestItem(item.seq , 'checked' , item)"></bo-button-collection>
                        <bo-button-collection *ngIf="item.best == 'checked'" class="margin-class" [title]="'베스트후기 해제'" 
                            [id]="'edit'" (click)="onClickBestItem(item.seq, 'none',  item)"></bo-button-collection>                      

                        <!--답변 -->
                        <bo-button-collection *ngIf="boardConfig?.auth.writeReply" class="margin-class"
                            [title]="item.re_contents?'답변수정':'답변등록'"
                            [id]="'recontents'"
                            (click)="onClickGoReplyPage(item.seq)" >
                        </bo-button-collection>

                        <bo-button-collection class="margin-class" [id]="'edit'" (click)="updateItem(item.seq)" ></bo-button-collection>
                        <bo-button-collection [id]="'copy'" (click)="onClickCopy(item.boardid , item.seq)"></bo-button-collection>
                        <bo-button-collection class="margin-class" [id]="'delete'" (click)="deleteItem(item.seq)"></bo-button-collection>
                    </ng-template>
                </data-table-column>
            </data-table>
        </div>
    </div>
</div>

<ng-template #template>
    <board-view [boardItem]="selectedItem" [boardConfig]="boardConfig" [boardId]="'goods_review'"
        (onClickButton)="onClickButton($event)">
    </board-view>
</ng-template>
